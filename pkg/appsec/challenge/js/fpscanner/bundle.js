function S(){return navigator.webdriver}function R(){return navigator.userAgent}function x(){return navigator.platform}var a="ERROR",r="INIT";var g="high";var C="medium";function p(t){let e=0;for(let n=0,o=t.length;n<o;n++){let c=t.charCodeAt(n);e=(e<<5)-e+c,e|=0}return e.toString(16).padStart(8,"0")}function m(t,e){for(let n in t)t[n]=e}function E(){try{let t=!1,e=Error.prepareStackTrace;Error.prepareStackTrace=function(){return t=!0,e};let n=new Error("");return console.log(n),t}catch{return a}}function A(){let t={vendor:r,renderer:r};try{var e=document.createElement("canvas"),n=e.getContext("webgl")||e.getContext("experimental-webgl");n.getSupportedExtensions().indexOf("WEBGL_debug_renderer_info")>=0?(t.vendor=n.getParameter(n.getExtension("WEBGL_debug_renderer_info").UNMASKED_VENDOR_WEBGL),t.renderer=n.getParameter(n.getExtension("WEBGL_debug_renderer_info").UNMASKED_RENDERER_WEBGL)):(t.vendor="NA",t.renderer="NA")}catch{t.vendor=a,t.renderer=a}return t}function W(){return"__pwInitScripts"in window||"__playwright__binding__"in window}function k(){return navigator.hardwareConcurrency||"NA"}function D(){let t=[],e=.123456789;return["E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"].forEach(function(c){try{t.push(Math[c])}catch{t.push(-1)}}),["tan","sin","exp","atan","acosh","asinh","atanh","expm1","log1p","sinh"].forEach(function(c){try{t.push(Math[c](e))}catch{t.push(-1)}}),p(t.map(String).join(","))}function P(){return navigator.deviceMemory||"NA"}function M(){return eval.toString().length}function I(){let t={timezone:r,localeLanguage:r};try{if(typeof Intl<"u"&&typeof Intl.DateTimeFormat<"u"){let e=Intl.DateTimeFormat().resolvedOptions();t.timezone=e.timeZone,t.localeLanguage=e.locale}else t.timezone="NA",t.localeLanguage="NA"}catch{t.timezone=a,t.localeLanguage=a}return t}function _(){return{width:window.screen.width,height:window.screen.height,pixelDepth:window.screen.pixelDepth,colorDepth:window.screen.colorDepth,availableWidth:window.screen.availWidth,availableHeight:window.screen.availHeight,innerWidth:window.innerWidth,innerHeight:window.innerHeight,hasMultipleDisplays:typeof screen.isExtended<"u"?screen.isExtended:"NA"}}function O(){return{languages:navigator.languages,language:navigator.language}}async function T(){let t={vendor:r,architecture:r,device:r,description:r};if("gpu"in navigator)try{let e=await navigator.gpu.requestAdapter();e&&(t.vendor=e.info.vendor,t.architecture=e.info.architecture,t.device=e.info.device,t.description=e.info.description)}catch{m(t,a)}else m(t,"NA");return t}function N(){let t=["__driver_evaluate","__webdriver_evaluate","__selenium_evaluate","__fxdriver_evaluate","__driver_unwrapped","__webdriver_unwrapped","__selenium_unwrapped","__fxdriver_unwrapped","_Selenium_IDE_Recorder","_selenium","calledSelenium","$cdc_asdjflasutopfhvcZLmcfl_","$chrome_asyncScriptInfo","__$webdriverAsyncExecutor","webdriver","__webdriverFunc","domAutomation","domAutomationController","__lastWatirAlert","__lastWatirConfirm","__lastWatirPrompt","__webdriver_script_fn","_WEBDRIVER_ELEM_CACHE"],e=!1;for(let n=0;n<t.length;n++)if(t[n]in window){e=!0;break}return e=e||!!document.__webdriver_script_fn||!!window.domAutomation||!!window.domAutomationController,e}function F(){try{let t="webdriver",e=window.navigator;if(!e[t]&&!e.hasOwnProperty(t)){e[t]=1;let n=e[t]===1;return delete e[t],n}return!0}catch{return!1}}async function H(){let t=window.navigator,e={architecture:r,bitness:r,brands:r,mobile:r,model:r,platform:r,platformVersion:r,uaFullVersion:r};if("userAgentData"in t)try{let n=await t.userAgentData.getHighEntropyValues(["architecture","bitness","brands","mobile","model","platform","platformVersion","uaFullVersion"]);e.architecture=n.architecture,e.bitness=n.bitness,e.brands=n.brands,e.mobile=n.mobile,e.model=n.model,e.platform=n.platform,e.platformVersion=n.platformVersion,e.uaFullVersion=n.uaFullVersion}catch{m(e,a)}else m(e,"NA");return e}function et(){if(!navigator.plugins)return!1;let t=typeof navigator.plugins.toString=="function"?navigator.plugins.toString():navigator.plugins.constructor&&typeof navigator.plugins.constructor.toString=="function"?navigator.plugins.constructor.toString():typeof navigator.plugins;return t==="[object PluginArray]"||t==="[object MSPluginsCollection]"||t==="[object HTMLPluginsCollection]"}function tt(){if(!navigator.plugins)return"NA";let t=[];for(let e=0;e<navigator.plugins.length;e++)t.push(navigator.plugins[e].name);return p(t.join(","))}function rt(){return navigator.plugins?navigator.plugins.length:"NA"}function nt(){if(!navigator.plugins)return"NA";try{return navigator.plugins[0]===navigator.plugins[0][0].enabledPlugin}catch{return a}}function ot(){if(!navigator.plugins)return"NA";try{return navigator.plugins.item(4294967296)!==navigator.plugins[0]}catch{return a}}function V(){let t={isValidPluginArray:r,pluginCount:r,pluginNamesHash:r,pluginConsistency1:r,pluginOverflow:r};try{t.isValidPluginArray=et(),t.pluginCount=rt(),t.pluginNamesHash=tt(),t.pluginConsistency1=nt(),t.pluginOverflow=ot()}catch{m(t,a)}return t}async function j(){return new Promise(async function(t){var e={audiooutput:0,audioinput:0,videoinput:0};if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices){let c=await navigator.mediaDevices.enumerateDevices();if(typeof c<"u"){for(var n=0;n<c.length;n++){var o=c[n].kind;e[o]=e[o]+1}return t({speakers:e.audiooutput,microphones:e.audioinput,webcams:e.videoinput})}else return m(e,"NA"),t(e)}else return m(e,"NA"),t(e)})}function L(){let t={webdriver:r,userAgent:r,platform:r,memory:r,cpuCount:r,language:r},e=document.createElement("iframe");try{e.style.display="none",e.src="about:blank",document.body.appendChild(e);let n=e.contentWindow?.navigator;t.webdriver=n.webdriver??!1,t.userAgent=n.userAgent??"NA",t.platform=n.platform??"NA",t.memory=n.deviceMemory??"NA",t.cpuCount=n.hardwareConcurrency??"NA",t.language=n.language??"NA"}catch{m(t,a)}finally{document.body.removeChild(e)}return t}async function B(){return new Promise(t=>{let e={vendor:r,renderer:r,userAgent:r,language:r,platform:r,memory:r,cpuCount:r};try{let n=`try {
                var fingerprintWorker = {};

                fingerprintWorker.userAgent = navigator.userAgent;
                fingerprintWorker.language = navigator.language;
                fingerprintWorker.cpuCount = navigator.hardwareConcurrency;
                fingerprintWorker.platform = navigator.platform;
                fingerprintWorker.memory = navigator.deviceMemory;
                

                var canvas = new OffscreenCanvas(1, 1);
                fingerprintWorker.vendor = 'INIT';
                fingerprintWorker.renderer = 'INIT';
                var gl = canvas.getContext('webgl');
                try {
                    if (gl) {
                        var glExt = gl.getExtension('WEBGL_debug_renderer_info');
                        fingerprintWorker.vendor = gl.getParameter(glExt.UNMASKED_VENDOR_WEBGL);
                        fingerprintWorker.renderer = gl.getParameter(glExt.UNMASKED_RENDERER_WEBGL);
                    } else {
                        fingerprintWorker.vendor = 'NA';
                        fingerprintWorker.renderer = 'NA';
                    }
                } catch (_) {
                    fingerprintWorker.vendor = 'ERROR';
                    fingerprintWorker.renderer = 'ERROR';
                }
                self.postMessage(fingerprintWorker);
            } catch (e) {
                self.postMessage(fingerprintWorker);
            }`,o=new Blob([n],{type:"application/javascript"}),c=URL.createObjectURL(o),d=new Worker(c);d.onmessage=function(l){try{return e.vendor=l.data.vendor,e.renderer=l.data.renderer,e.userAgent=l.data.userAgent,e.language=l.data.language,e.platform=l.data.platform,e.memory=l.data.memory,e.cpuCount=l.data.cpuCount,t(e)}catch{return m(e,a),t(e)}}}catch{return m(e,a),t(e)}})}function G(){let t={toSourceError:r,hasToSource:!1};try{null.usdfsh}catch(e){t.toSourceError=e.toString()}try{throw"xyz"}catch(e){try{e.toSource(),t.hasToSource=!0}catch{t.hasToSource=!1}}return t}var U=['audio/mp4; codecs="mp4a.40.2"',"audio/mpeg;",'audio/webm; codecs="vorbis"','audio/ogg; codecs="vorbis"','audio/wav; codecs="1"','audio/ogg; codecs="speex"','audio/ogg; codecs="flac"','audio/3gpp; codecs="samr"'],$=['video/mp4; codecs="avc1.42E01E, mp4a.40.2"','video/mp4; codecs="avc1.42E01E"','video/mp4; codecs="avc1.58A01E"','video/mp4; codecs="avc1.4D401E"','video/mp4; codecs="avc1.64001E"','video/mp4; codecs="mp4v.20.8"','video/mp4; codecs="mp4v.20.240"','video/webm; codecs="vp8"','video/ogg; codecs="theora"','video/ogg; codecs="dirac"','video/3gpp; codecs="mp4v.20.8"','video/x-matroska; codecs="theora"'];function z(t,e){let n={};try{let o=document.createElement(e);for(let c of t)try{n[c]=o.canPlayType(c)||null}catch{n[c]=null}}catch{for(let o of t)n[o]=null}return n}function Q(t){let e={},n=window.MediaSource;if(!n||typeof n.isTypeSupported!="function"){for(let o of t)e[o]=null;return e}for(let o of t)try{e[o]=n.isTypeSupported(o)}catch{e[o]=null}return e}function K(t){try{let e=window.RTCRtpReceiver;if(e&&typeof e.getCapabilities=="function"){let n=e.getCapabilities(t);return p(JSON.stringify(n))}return"NA"}catch{return a}}function J(){let t={audioCanPlayTypeHash:"NA",videoCanPlayTypeHash:"NA",audioMediaSourceHash:"NA",videoMediaSourceHash:"NA",rtcAudioCapabilitiesHash:"NA",rtcVideoCapabilitiesHash:"NA",hasMediaSource:!1};try{t.hasMediaSource=!!window.MediaSource;let e=z(U,"audio"),n=z($,"video");t.audioCanPlayTypeHash=p(JSON.stringify(e)),t.videoCanPlayTypeHash=p(JSON.stringify(n));let o=Q(U),c=Q($);t.audioMediaSourceHash=p(JSON.stringify(o)),t.videoMediaSourceHash=p(JSON.stringify(c)),t.rtcAudioCapabilitiesHash=K("audio"),t.rtcVideoCapabilitiesHash=K("video")}catch{m(t,a)}return t}async function it(){return new Promise(t=>{try{let e=new Image,n=document.createElement("canvas").getContext("2d");e.onload=()=>{n.drawImage(e,0,0),t(n.getImageData(0,0,1,1).data.filter(o=>o===0).length!=4)},e.onerror=()=>{t(a)},e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}catch{t(a)}})}function at(){var t=document.createElement("canvas");t.width=400,t.height=200,t.style.display="inline";var e=t.getContext("2d");try{return e.rect(0,0,10,10),e.rect(2,2,6,6),e.textBaseline="alphabetic",e.fillStyle="#f60",e.fillRect(125,1,62,20),e.fillStyle="#069",e.font="11pt no-real-font-123",e.fillText("Cwm fjordbank glyphs vext quiz, \u{1F603}",2,15),e.fillStyle="rgba(102, 204, 0, 0.2)",e.font="18pt Arial",e.fillText("Cwm fjordbank glyphs vext quiz, \u{1F603}",4,45),e.globalCompositeOperation="multiply",e.fillStyle="rgb(255,0,255)",e.beginPath(),e.arc(50,50,50,0,2*Math.PI,!0),e.closePath(),e.fill(),e.fillStyle="rgb(0,255,255)",e.beginPath(),e.arc(100,50,50,0,2*Math.PI,!0),e.closePath(),e.fill(),e.fillStyle="rgb(255,255,0)",e.beginPath(),e.arc(75,100,50,0,2*Math.PI,!0),e.closePath(),e.fill(),e.fillStyle="rgb(255,0,255)",e.arc(75,75,75,0,2*Math.PI,!0),e.arc(75,75,25,0,2*Math.PI,!0),e.fill("evenodd"),p(t.toDataURL())}catch{return a}}async function q(){let t={hasModifiedCanvas:r,canvasFingerprint:r};return t.hasModifiedCanvas=await it(),t.canvasFingerprint=at(),t}function Y(){let t=["deviceMemory","hardwareConcurrency","language","languages","platform"],e=[];for(let n of t){let o=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(navigator),n);o&&o.value?e.push("1"):e.push("0")}return e.join("")}function Z(){return Math.random().toString(36).substring(2,15)}function X(){return new Date().getTime()}function ee(){return window.location.href}function y(t,e){let n=t.signals;return e==="iframe"?n.contexts.iframe.webdriver!==n.automation.webdriver||n.contexts.iframe.userAgent!==n.browser.userAgent||n.contexts.iframe.platform!==n.device.platform||n.contexts.iframe.memory!==n.device.memory||n.contexts.iframe.cpuCount!==n.device.cpuCount:n.contexts.webWorker.webdriver!==n.automation.webdriver||n.contexts.webWorker.userAgent!==n.browser.userAgent||n.contexts.webWorker.platform!==n.device.platform||n.contexts.webWorker.memory!==n.device.memory||n.contexts.webWorker.cpuCount!==n.device.cpuCount}function te(){let t={bitmask:r,extensions:[]},e=document.body.hasAttribute("data-gr-ext-installed"),n=typeof window.ethereum<"u",o=document.getElementById("coupon-birds-drop-div")!==null,c=document.querySelector("deepl-input-controller")!==null,d=document.getElementById("monica-content-root")!==null,l=document.querySelector("chatgpt-sidebar")!==null,s=typeof window.__REQUESTLY__<"u",h=Array.from(document.querySelectorAll("*")).filter(f=>f.tagName.toLowerCase().startsWith("veepn-")).length>0;return t.bitmask=[e?"1":"0",n?"1":"0",o?"1":"0",c?"1":"0",d?"1":"0",l?"1":"0",s?"1":"0",h?"1":"0"].join(""),e&&t.extensions.push("grammarly"),n&&t.extensions.push("metamask"),o&&t.extensions.push("coupon-birds"),c&&t.extensions.push("deepl"),d&&t.extensions.push("monica-ai"),l&&t.extensions.push("sider-ai"),s&&t.extensions.push("requestly"),h&&t.extensions.push("veepn"),t}function re(){let t={bitmask:r,chrome:"chrome"in window,brave:"brave"in navigator,applePaySupport:"ApplePaySetup"in window,opera:typeof window.opr<"u"||typeof window.onoperadetachedviewchange=="object",serial:window.navigator.serial!==void 0,attachShadow:!!Element.prototype.attachShadow,caches:!!window.caches,webAssembly:!!window.WebAssembly&&!!window.WebAssembly.instantiate,buffer:"Buffer"in window,showModalDialog:"showModalDialog"in window},e=Object.keys(t).filter(n=>n!=="bitmask").map(n=>t[n]?"1":"0").join("");return t.bitmask=e,t}function ne(){let t={prefersColorScheme:r,prefersReducedMotion:r,prefersReducedTransparency:r,colorGamut:r,pointer:r,anyPointer:r,hover:r,anyHover:r,colorDepth:r};try{window.matchMedia("(prefers-color-scheme: dark)").matches?t.prefersColorScheme="dark":window.matchMedia("(prefers-color-scheme: light)").matches?t.prefersColorScheme="light":t.prefersColorScheme=null,t.prefersReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches,t.prefersReducedTransparency=window.matchMedia("(prefers-reduced-transparency: reduce)").matches,window.matchMedia("(color-gamut: rec2020)").matches?t.colorGamut="rec2020":window.matchMedia("(color-gamut: p3)").matches?t.colorGamut="p3":window.matchMedia("(color-gamut: srgb)").matches?t.colorGamut="srgb":t.colorGamut=null,window.matchMedia("(pointer: fine)").matches?t.pointer="fine":window.matchMedia("(pointer: coarse)").matches?t.pointer="coarse":window.matchMedia("(pointer: none)").matches?t.pointer="none":t.pointer=null,window.matchMedia("(any-pointer: fine)").matches?t.anyPointer="fine":window.matchMedia("(any-pointer: coarse)").matches?t.anyPointer="coarse":window.matchMedia("(any-pointer: none)").matches?t.anyPointer="none":t.anyPointer=null,t.hover=window.matchMedia("(hover: hover)").matches,t.anyHover=window.matchMedia("(any-hover: hover)").matches;let e=0;for(let n=0;n<=16;n++)window.matchMedia(`(color: ${n})`).matches&&(e=n);t.colorDepth=e}catch{m(t,a)}return t}function oe(t){let e=t.signals.device.screenResolution;return typeof e.width!="number"||typeof e.height!="number"?!1:e.width===600&&e.height===800||e.availableWidth===600&&e.availableHeight===800||e.innerWidth===600&&e.innerHeight===800}function ie(t){return t.signals.automation.webdriver===!0}function ae(t){return!!t.signals.automation.selenium}function se(t){return t.signals.automation.cdp===!0}function ce(t){return t.signals.automation.playwright===!0}function le(t){return typeof t.signals.device.memory!="number"?!1:t.signals.device.memory>8||t.signals.device.memory<.25}function ue(t){return typeof t.signals.device.cpuCount!="number"?!1:t.signals.device.cpuCount>70}function pe(t){let e=t.signals.browser.userAgent;return t.signals.browser.features.chrome===!1&&typeof e=="string"&&e.includes("Chrome")}function me(t){return t.signals.contexts.iframe.webdriver===!0}function de(t){return t.signals.contexts.webWorker.webdriver===!0}function ge(t){let e=t.signals.contexts.webWorker,n=t.signals.graphics.webGL;return e.vendor===a||e.renderer===a||n.vendor==="NA"||n.renderer==="NA"?!1:e.vendor!==n.vendor||e.renderer!==n.renderer}function he(t){return t.signals.contexts.webWorker.platform==="NA"||t.signals.contexts.webWorker.platform===a?!1:t.signals.device.platform!==t.signals.contexts.webWorker.platform}function fe(t){return t.signals.contexts.iframe.platform==="NA"||t.signals.contexts.iframe.platform===a?!1:t.signals.device.platform!==t.signals.contexts.iframe.platform}function ye(t){return t.signals.automation.webdriverWritable===!0}function ve(t){return t.signals.graphics.webGL.renderer.includes("SwiftShader")}function we(t){return t.signals.locale.internationalization.timezone==="UTC"}async function be(t,e){let n=new TextEncoder().encode(e),o=new TextEncoder().encode(t),c=new Uint8Array(o.length);for(let l=0;l<o.length;l++)c[l]=o[l]^n[l%n.length];let d=String.fromCharCode(...c);return btoa(d)}var v=class{fingerprint;constructor(){this.fingerprint={signals:{automation:{webdriver:r,webdriverWritable:r,selenium:r,cdp:r,playwright:r,navigatorPropertyDescriptors:r},device:{cpuCount:r,memory:r,platform:r,screenResolution:{width:r,height:r,pixelDepth:r,colorDepth:r,availableWidth:r,availableHeight:r,innerWidth:r,innerHeight:r,hasMultipleDisplays:r},multimediaDevices:{speakers:r,microphones:r,webcams:r},mediaQueries:{prefersColorScheme:r,prefersReducedMotion:r,prefersReducedTransparency:r,colorGamut:r,pointer:r,anyPointer:r,hover:r,anyHover:r,colorDepth:r}},browser:{userAgent:r,features:{bitmask:r,chrome:r,brave:r,applePaySupport:r,opera:r,serial:r,attachShadow:r,caches:r,webAssembly:r,buffer:r,showModalDialog:r},plugins:{isValidPluginArray:r,pluginCount:r,pluginNamesHash:r,pluginConsistency1:r,pluginOverflow:r},extensions:{bitmask:r,extensions:r},highEntropyValues:{architecture:r,bitness:r,brands:r,mobile:r,model:r,platform:r,platformVersion:r,uaFullVersion:r},etsl:r,maths:r,toSourceError:{toSourceError:r,hasToSource:r}},graphics:{webGL:{vendor:r,renderer:r},webgpu:{vendor:r,architecture:r,device:r,description:r},canvas:{hasModifiedCanvas:r,canvasFingerprint:r}},codecs:{audioCanPlayTypeHash:r,videoCanPlayTypeHash:r,audioMediaSourceHash:r,videoMediaSourceHash:r,rtcAudioCapabilitiesHash:r,rtcVideoCapabilitiesHash:r,hasMediaSource:r},locale:{internationalization:{timezone:r,localeLanguage:r},languages:{languages:r,language:r}},contexts:{iframe:{webdriver:r,userAgent:r,platform:r,memory:r,cpuCount:r,language:r},webWorker:{webdriver:r,userAgent:r,platform:r,memory:r,cpuCount:r,language:r,vendor:r,renderer:r}}},fsid:r,nonce:r,time:r,url:r,fastBotDetection:!1,fastBotDetectionDetails:{headlessChromeScreenResolution:{detected:!1,severity:"high"},hasWebdriver:{detected:!1,severity:"high"},hasWebdriverWritable:{detected:!1,severity:"high"},hasSeleniumProperty:{detected:!1,severity:"high"},hasCDP:{detected:!1,severity:"high"},hasPlaywright:{detected:!1,severity:"high"},hasImpossibleDeviceMemory:{detected:!1,severity:"high"},hasHighCPUCount:{detected:!1,severity:"high"},hasMissingChromeObject:{detected:!1,severity:"high"},hasWebdriverIframe:{detected:!1,severity:"high"},hasWebdriverWorker:{detected:!1,severity:"high"},hasMismatchWebGLInWorker:{detected:!1,severity:"high"},hasMismatchPlatformIframe:{detected:!1,severity:"high"},hasMismatchPlatformWorker:{detected:!1,severity:"high"}}}}async collectSignal(e){try{return await e()}catch{return a}}generateFingerprintScannerId(){try{let e=this.fingerprint.signals,n=this.fingerprint.fastBotDetectionDetails,o="FS1",d=[n.headlessChromeScreenResolution.detected,n.hasWebdriver.detected,n.hasWebdriverWritable.detected,n.hasSeleniumProperty.detected,n.hasCDP.detected,n.hasPlaywright.detected,n.hasImpossibleDeviceMemory.detected,n.hasHighCPUCount.detected,n.hasMissingChromeObject.detected,n.hasWebdriverIframe.detected,n.hasWebdriverWorker.detected,n.hasMismatchWebGLInWorker.detected,n.hasMismatchPlatformIframe.detected,n.hasMismatchPlatformWorker.detected].map(u=>u?"1":"0").join(""),l=[e.automation.webdriver===!0,e.automation.webdriverWritable===!0,e.automation.selenium===!0,e.automation.cdp===!0,e.automation.playwright===!0].map(u=>u?"1":"0").join(""),s=p(String(e.automation.navigatorPropertyDescriptors)).slice(0,4),h=`${l}h${s}`,f=typeof e.device.screenResolution.width=="number"?e.device.screenResolution.width:0,Ce=typeof e.device.screenResolution.height=="number"?e.device.screenResolution.height:0,Ee=typeof e.device.cpuCount=="number"?String(e.device.cpuCount).padStart(2,"0"):"00",Ae=typeof e.device.memory=="number"?String(Math.round(e.device.memory)).padStart(2,"0"):"00",We=[e.device.screenResolution.hasMultipleDisplays===!0,e.device.mediaQueries.prefersReducedMotion===!0,e.device.mediaQueries.prefersReducedTransparency===!0,e.device.mediaQueries.hover===!0,e.device.mediaQueries.anyHover===!0].map(u=>u?"1":"0").join(""),ke=[e.device.platform,e.device.screenResolution.pixelDepth,e.device.screenResolution.colorDepth,e.device.multimediaDevices.speakers,e.device.multimediaDevices.microphones,e.device.multimediaDevices.webcams,e.device.mediaQueries.prefersColorScheme,e.device.mediaQueries.colorGamut,e.device.mediaQueries.pointer,e.device.mediaQueries.anyPointer,e.device.mediaQueries.colorDepth].map(u=>String(u)).join("|"),De=p(ke).slice(0,6),Pe=`${f}x${Ce}c${Ee}m${Ae}b${We}h${De}`,Me=typeof e.browser.features.bitmask=="string"?e.browser.features.bitmask:"0000000000",Ie=typeof e.browser.extensions.bitmask=="string"?e.browser.extensions.bitmask:"00000000",_e=[e.browser.plugins.isValidPluginArray===!0,e.browser.plugins.pluginConsistency1===!0,e.browser.plugins.pluginOverflow===!0,e.browser.toSourceError.hasToSource===!0].map(u=>u?"1":"0").join(""),Oe=[e.browser.userAgent,e.browser.etsl,e.browser.maths,e.browser.plugins.pluginCount,e.browser.plugins.pluginNamesHash,e.browser.toSourceError.toSourceError,e.browser.highEntropyValues.architecture,e.browser.highEntropyValues.bitness,e.browser.highEntropyValues.platform,e.browser.highEntropyValues.platformVersion,e.browser.highEntropyValues.uaFullVersion,e.browser.highEntropyValues.mobile].map(u=>String(u)).join("|"),Te=p(Oe).slice(0,6),Ne=`f${Me}e${Ie}p${_e}h${Te}`,Fe=[e.graphics.canvas.hasModifiedCanvas===!0].map(u=>u?"1":"0").join(""),He=[e.graphics.webGL.vendor,e.graphics.webGL.renderer,e.graphics.webgpu.vendor,e.graphics.webgpu.architecture,e.graphics.webgpu.device,e.graphics.webgpu.description,e.graphics.canvas.canvasFingerprint].map(u=>String(u)).join("|"),Ve=p(He).slice(0,6),je=`${Fe}h${Ve}`,Le=[e.codecs.hasMediaSource===!0].map(u=>u?"1":"0").join(""),Be=[e.codecs.audioCanPlayTypeHash,e.codecs.videoCanPlayTypeHash,e.codecs.audioMediaSourceHash,e.codecs.videoMediaSourceHash,e.codecs.rtcAudioCapabilitiesHash,e.codecs.rtcVideoCapabilitiesHash].map(u=>String(u)).join("|"),Ge=p(Be).slice(0,6),Ue=`${Le}h${Ge}`,$e=typeof e.locale.languages.language=="string"?e.locale.languages.language.slice(0,2).toLowerCase():"xx",ze=Array.isArray(e.locale.languages.languages)?e.locale.languages.languages.length:0,Qe=[e.locale.internationalization.timezone,e.locale.internationalization.localeLanguage,Array.isArray(e.locale.languages.languages)?e.locale.languages.languages.join(","):e.locale.languages.languages,e.locale.languages.language].map(u=>String(u)).join("|"),Ke=p(Qe).slice(0,4),Je=`${$e}${ze}h${Ke}`,qe=[y(this.fingerprint,"iframe"),y(this.fingerprint,"worker"),e.contexts.iframe.webdriver===!0,e.contexts.webWorker.webdriver===!0].map(u=>u?"1":"0").join(""),Ye=[e.contexts.iframe.userAgent,e.contexts.iframe.platform,e.contexts.iframe.memory,e.contexts.iframe.cpuCount,e.contexts.iframe.language,e.contexts.webWorker.userAgent,e.contexts.webWorker.platform,e.contexts.webWorker.memory,e.contexts.webWorker.cpuCount,e.contexts.webWorker.language,e.contexts.webWorker.vendor,e.contexts.webWorker.renderer].map(u=>String(u)).join("|"),Ze=p(Ye).slice(0,6),Xe=`${qe}h${Ze}`;return[o,d,h,Pe,Ne,je,Ue,Je,Xe].join("_")}catch(e){return console.error("Error generating fingerprint scanner id",e),a}}async encryptFingerprint(e){let n=__FP_ENCRYPTION_KEY__;return await be(JSON.stringify(e),n)}getDetectionRules(){return[{name:"headlessChromeScreenResolution",severity:g,test:oe},{name:"hasWebdriver",severity:g,test:ie},{name:"hasWebdriverWritable",severity:g,test:ye},{name:"hasSeleniumProperty",severity:g,test:ae},{name:"hasCDP",severity:g,test:se},{name:"hasPlaywright",severity:g,test:ce},{name:"hasImpossibleDeviceMemory",severity:g,test:le},{name:"hasHighCPUCount",severity:g,test:ue},{name:"hasMissingChromeObject",severity:g,test:pe},{name:"hasWebdriverIframe",severity:g,test:me},{name:"hasWebdriverWorker",severity:g,test:de},{name:"hasMismatchWebGLInWorker",severity:g,test:ge},{name:"hasMismatchPlatformIframe",severity:g,test:fe},{name:"hasMismatchPlatformWorker",severity:g,test:he},{name:"hasSwiftshaderRenderer",severity:"low",test:ve},{name:"hasUTCTimezone",severity:C,test:we}]}runDetectionRules(){let e=this.getDetectionRules(),n={headlessChromeScreenResolution:{detected:!1,severity:"high"},hasWebdriver:{detected:!1,severity:"high"},hasWebdriverWritable:{detected:!1,severity:"high"},hasSeleniumProperty:{detected:!1,severity:"high"},hasCDP:{detected:!1,severity:"high"},hasPlaywright:{detected:!1,severity:"high"},hasImpossibleDeviceMemory:{detected:!1,severity:"high"},hasHighCPUCount:{detected:!1,severity:"high"},hasMissingChromeObject:{detected:!1,severity:"high"},hasWebdriverIframe:{detected:!1,severity:"high"},hasWebdriverWorker:{detected:!1,severity:"high"},hasMismatchWebGLInWorker:{detected:!1,severity:"high"},hasMismatchPlatformIframe:{detected:!1,severity:"high"},hasMismatchPlatformWorker:{detected:!1,severity:"high"}};for(let o of e)try{let c=o.test(this.fingerprint);n[o.name]={detected:c,severity:o.severity}}catch{n[o.name]={detected:!1,severity:o.severity}}return n}async collectFingerprint(e={encrypt:!0}){let{encrypt:n=!0}=e,o=this.fingerprint.signals,c={webdriver:this.collectSignal(S),webdriverWritable:this.collectSignal(F),selenium:this.collectSignal(N),cdp:this.collectSignal(E),playwright:this.collectSignal(W),navigatorPropertyDescriptors:this.collectSignal(Y),cpuCount:this.collectSignal(k),memory:this.collectSignal(P),platform:this.collectSignal(x),screenResolution:this.collectSignal(_),multimediaDevices:this.collectSignal(j),mediaQueries:this.collectSignal(ne),userAgent:this.collectSignal(R),browserFeatures:this.collectSignal(re),plugins:this.collectSignal(V),browserExtensions:this.collectSignal(te),highEntropyValues:this.collectSignal(H),etsl:this.collectSignal(M),maths:this.collectSignal(D),toSourceError:this.collectSignal(G),webGL:this.collectSignal(A),webgpu:this.collectSignal(T),canvas:this.collectSignal(q),mediaCodecs:this.collectSignal(J),internationalization:this.collectSignal(I),languages:this.collectSignal(O),iframe:this.collectSignal(L),webWorker:this.collectSignal(B),nonce:this.collectSignal(Z),time:this.collectSignal(X),url:this.collectSignal(ee)},d=Object.keys(c),l=await Promise.all(Object.values(c)),s=Object.fromEntries(d.map((h,f)=>[h,l[f]]));return o.automation.webdriver=s.webdriver,o.automation.webdriverWritable=s.webdriverWritable,o.automation.selenium=s.selenium,o.automation.cdp=s.cdp,o.automation.playwright=s.playwright,o.automation.navigatorPropertyDescriptors=s.navigatorPropertyDescriptors,o.device.cpuCount=s.cpuCount,o.device.memory=s.memory,o.device.platform=s.platform,o.device.screenResolution=s.screenResolution,o.device.multimediaDevices=s.multimediaDevices,o.device.mediaQueries=s.mediaQueries,o.browser.userAgent=s.userAgent,o.browser.features=s.browserFeatures,o.browser.plugins=s.plugins,o.browser.extensions=s.browserExtensions,o.browser.highEntropyValues=s.highEntropyValues,o.browser.etsl=s.etsl,o.browser.maths=s.maths,o.browser.toSourceError=s.toSourceError,o.graphics.webGL=s.webGL,o.graphics.webgpu=s.webgpu,o.graphics.canvas=s.canvas,o.codecs=s.mediaCodecs,o.locale.internationalization=s.internationalization,o.locale.languages=s.languages,o.contexts.iframe=s.iframe,o.contexts.webWorker=s.webWorker,this.fingerprint.nonce=s.nonce,this.fingerprint.time=s.time,this.fingerprint.url=s.url,this.fingerprint.fastBotDetectionDetails=this.runDetectionRules(),this.fingerprint.fastBotDetection=Object.values(this.fingerprint.fastBotDetectionDetails).some(h=>h.detected),this.fingerprint.fsid=this.generateFingerprintScannerId(),console.log(this.fingerprint),n?await this.encryptFingerprint(JSON.stringify(this.fingerprint)):this.fingerprint}},Se=v;async function ct(t){let e=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(t));return Array.from(new Uint8Array(e)).map(c=>c.toString(16).padStart(2,"0")).join("")}async function lt(t,e){let n=new TextEncoder,o=n.encode(t),c=n.encode(e),d=await crypto.subtle.importKey("raw",o,{name:"HMAC",hash:"SHA-256"},!1,["sign"]),l=await crypto.subtle.sign("HMAC",d,c);return Array.from(new Uint8Array(l)).map(f=>f.toString(16).padStart(2,"0")).join("")}async function ut(t,e){let n=new TextEncoder().encode(t),o=new TextEncoder().encode(e),c=new Uint8Array(o.length);for(let l=0;l<o.length;l++)c[l]=o[l]^n[l%n.length];let d=String.fromCharCode(...c);return btoa(d)}var Re="__CROWDSEC_TIMESTAMP__",w="__CROWDSEC_TICKET__";await new Promise(t=>setTimeout(t,4e3));var pt=new Se,mt=await pt.collectFingerprint({encrypt:!1}),b=await ct(w),xe=await ut(b,JSON.stringify(mt)),dt=await lt(b,xe+Re+w);fetch("/crowdsec-internal/challenge/submit",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({f:xe,t:w,ts:Re,h:dt,s:b})}).then(t=>t.json()).then(t=>console.log(t)).catch(t=>console.error("Error submitting fingerprint:",t));
