---
- name: "install netcat (Amazon, Fedora, CentOS)"
  become: true
  ansible.builtin.package:
    name:
      - nmap-ncat
  when:
    - ansible_facts.distribution in ['Amazon',  'Fedora', 'CentOS', 'OracleLinux']

- name: "install netcat (RedHat)"
  become: true
  ansible.builtin.package:
    name:
      - netcat
  when:
    - (ansible_facts.distribution == 'RedHat') or  (ansible_facts.distribution == 'AlmaLinux')

# "netcat" does not exist in some versions (only -traditional or -openbsd)
- name: "install netcat (Debian)"
  become: true
  ansible.builtin.package:
    name:
      - netcat-traditional
  when:
    - ansible_facts.os_family == "Debian"

# "netcat" does not exist in some versions (only -traditional or -openbsd)
- name: "install netcat (Suse)"
  become: true
  ansible.builtin.package:
    name:
      - netcat-openbsd
  when:
    - ansible_facts.os_family == "Suse"
